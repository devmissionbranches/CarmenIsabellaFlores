YUI.add("privacy-footer-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,buildContainer:function(){return this.setContainerWithTemplate("privacy-footer",{url:"https://www.smugmug.com/together/?utm_campaign=flickr-launch&utm_source=Flickr&utm_medium=product&utm_content=notice-bar"}),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-privacy-footer"],langBundles:["common","privacy"]});YUI.add("hermes-lang-privacy",function(e,n){e.Intl.add("hermes/privacy","en-US",{OATH_DATA_USAGE:["Flickr and Yahoo are now part of “Oath” and are members of the Verizon family of companies. Beginning 15 September 2017, we plan to share some user information within our new family."],SM:["Exciting news: Flickr is joining SmugMug!"]})},"@VERSION@",{requires:["intl"]});YUI.add("footer-full-view",function(e){var t=["en-US","zh-HK","de-DE","es-US","fr-FR","ko-KR","it-IT","pt-BR","vn-VN","id-ID"],o={"en-US":"English","de-DE":"Deutsch","es-US":"Español","fr-FR":"Français","ko-KR":"한글","it-IT":"Italiano","pt-BR":"Português","vn-VN":"Tiếng Việt","id-ID":"Bahasa Indonesia","zh-HK":"繁體中文"};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML('<div class="footer-full-content"></div>'),this.appStateParams=e,this},subviewConfig:{"privacy-footer-view":{requiredToShowOnServer:!1,requiredToShowOnClient:!1,additionalViewClasses:["hidden"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-smug-service-notice")}}},loadState:function(){var s,n,i;for(i=this.appContext.auth&&this.appContext.auth.csrf?this.appContext.auth.csrf:"",this.lang=this.appContext.lang,this.menuLangs=[],"zh-Hant-HK"===this.lang&&(this.lang="zh-HK"),"vi-vn"===this.lang.toLowerCase()&&(this.lang="vn-VN"),this.selectedLang={code:this.lang,name:o[this.lang],csrf:i},s=0,n=t.length;s<n;s++)t[s]!==this.lang&&"string"==typeof t[s]&&this.menuLangs.push({code:t[s].toLowerCase(),name:o[t[s]],csrf:i});return e.Promise.resolve()},buildContainer:function(){var t={};return this.get("viewer")&&e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))}),(t={displayLangs:this.displayLangs,selectedLang:this.selectedLang,helpLocaleKey:this.selectedLang.code.replace("-","_")||"en_US",menuLangs:this.menuLangs,elements:this.setElementStates()}).elements.bottom_row||this.get("container").addClass("compact"),YUI.Env.isServer?t.pageUrl=this.appContext.request.url:t.pageUrl=window.location.pathname,this.setContainerWithTemplate("footer-full",t),this},activate:function(){var t=this.get("container"),o=t.one(".lang-switcher"),s=o.one("a");return this.appContext.flipper.isFlipped("enable-smug-service-notice")&&(this.appContext.hasClientSideRouted()||e.StorageHelper.hasEntries("privacyFooterSMDismissed")||t.addClass("privacy-footer"),this.registerEventHandler(t.one(".dismiss").on("click",function(){e.StorageHelper.setItem("privacyFooterSMDismissed",!0),t.removeClass("privacy-footer")}))),this.menuLangsFormatted=this.menuLangs.map(function(e){return{href:"/change_language.gne?lang="+e.code+"&csrf="+e.csrf,text:e.name}}),this.registerEventHandler(o.on("click",function(t){t.preventDefault(),s.addClass("dimmed");var n=new e.Views.FluidDroparound({anchorOffsetHorizontal:15,appContext:this.appContext,showDropArrow:!0,observePageResize:!0,dismissOnOverlayClick:!0,anchorElement:o.one(".arrow"),classList:["lang-droparound"],menuItems:this.menuLangsFormatted});n.show(),this.registerEventHandler(n.on("closeDroparound",function(e){s.removeClass("dimmed")}),this)},this)),this},setElementStates:function(){var e={top_row:!0,top_about:!0,top_jobs:!0,top_blog:!0,top_mobile:!0,top_developers:!0,top_guidelines:!0,top_privacy:!1,top_terms:!1,top_yahoo_safely:!1,top_feedback:!0,top_report_abuse:!0,top_help_forum:!0,top_language:!0,bottom_row:!0,bottom_privacy:!0,bottom_terms:!0,bottom_yahoo_safely:!0,bottom_help:!0,bottom_yahoo_company:!1,bottom_tumblr:!0,bottom_facebook:!0,bottom_twitter:!0};return this.appStateParams.isSOHP&&(e.top_privacy=!0,e.top_terms=!0,e.top_yahoo_safely=!0,e.top_feedback=!1,e.top_report_abuse=!1,e.bottom_row=!1),e}})},"@VERSION@",{requires:["flickr-view","hermes-template-footer-full","url-helper","dropdown","fluid-droparound-view","privacy-footer-view"],langBundles:["common"]});YUI.add("photolist-aft-helper",function(t){"use strict";t.PhotolistAftHelper=function(t,e){var i=t.onSubviewEvent;this.appContext=t.appContext,this.viewName=t.name,this.container=t.get("container"),e&&(this.hasRequiredSubviews=!0,this.paftResults={},e.forEach(function(t){this.paftResults[t]={}}.bind(this))),YUI.Env.isServer||this.appContext.clientMetrics.setPendingMeasurement(t.name,!0),t.onSubviewEvent=function(e,s){(s&&"atfVisible"===s[0]||"atfActivated"===s[0])&&this.aftHelper.handleAFTResult(e,s),i&&i.call(t,e,s)}},t.PhotolistAftHelper.prototype.handleAFTResult=function(t,e){var i=e[0];if(this.hasRequiredSubviews){if(e.length>2&&this.container){var s=this.container.one("."+e[2]);if(s&&!(function(t){var e=(t=t.getDOMNode()).getBoundingClientRect();return e.top>=window.pageYOffset&&e.left>=window.pageXOffset})(s))return delete this.paftResults[e[2]],void this.beaconIfAllAFTResultsComplete(i)}t=e[2]}this.paftResults||(this.paftResults={},this.hasRequiredSubviews||(this.paftResults[t]={})),this.paftResults[t][i]=e[1]||(new Date).getTime(),this.beaconIfAllAFTResultsComplete(i)},t.PhotolistAftHelper.prototype.beaconIfAllAFTResultsComplete=function(e){var i,s=0;this.allResultsReceived||(this.allResultsReceived=Object.keys(this.paftResults).every(function(t){return void 0!==(i=this.paftResults[t][e])&&(i>s&&(s=i),!0)}.bind(this)),this.allResultsReceived&&"atfVisible"===e&&(this.appContext.hasClientSideRouted()?(this.appContext.clientMetrics.mark("AFT_CL",s),this.appContext.clientMetrics.mark("AFT",s)):(t.config.win.performance&&t.config.win.performance.timing&&(s-=t.config.win.performance.timing.navigationStart),this.appContext.clientMetrics.record("AFT_SV",s),this.appContext.clientMetrics.record("AFT",s)),this.appContext.clientMetrics.setPendingMeasurement(this.viewName,!1),this.appContext.clientMetrics.beacon()))}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom"]});YUI.add("album-page-view",function(e,t){var i=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.albumId=t.albumId,this.isOwner=t.isOwner,this.isTwitterbot=t.isTwitterbot,this.albumPhotoListLayoutStyle=t.albumPhotoListLayoutStyle,t.id=t.albumId,t.modelRegistryName="set-models",t.maxNumAttrName="totalCount",this.pageParams=t.pageParams,t.photoListConfig={modelParams:{registryName:"set-models",modelIdOrAttributes:t.albumId,collectionAttributeName:"photoPageList"},parentName:this.name,pageParams:t.pageParams,contextSuffix:"album-"+t.albumId,measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:t.withPhotoId},t.photoListConfig.layout={targetRowHeight:"justified"===this.albumPhotoListLayoutStyle?190:430,fullWidthBreakoutRowCadence:"justified"===this.albumPhotoListLayoutStyle?null:3,awakeBoundsToViewportSizeRatio:5,containerPadding:{top:4,right:0,bottom:4,left:0},itemSpacing:{horizontal:4,vertical:4}},this.aftHelper=new e.PhotolistAftHelper(this),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"album-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.pageParams.viewPageSize}},"signup-footer-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("set-models",this.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){return this.setContainerWithTemplate("album-page"),this},buildHeadContainer:function(){var t,a,o,r,l=this.get("albumModel"),s=l.getValue("photoPageList").getList(),n="summary",u=[],h=(this.pageParams.nominalPage-1)*this.pageParams.viewPageSizeForShare||0;if(this.isTwitterbot&&s.length-h>=4)for(n="gallery",o=0;o<Math.min(s.length-h,4);o++)if(s[h+o]){var m=s[h+o].getSizeToFit({width:640,height:640});m&&m.url&&u.push({property:"twitter:image"+o,content:m.url})}else i.error("Missing album photo in album list",{index:h+o});l.registry?t=l.registry.getSizeToFit(this.albumId,{width:640,height:640}):i.error("Missing album model registry"),r=l.getValue("url").replace(/\/albums\/([0-9]+)/i,"/sets/$1"),a=this.templates("dynamic-page-head")({title:l.getValue("title"),description:l.getValue("description")||this.intlMessage({intlName:"album-page.OPENGRAPH_DESCRIPTION",owner:l.getValue("owner").getValue("displayname")}),url:l.getValue("url"),fullURL:e.url(r),openGraphImageURL:t?e.URLHelper.addProtocolToURL(t.url):"",openGraphaImageWidth:t?t.width:"",openGraphaImageHeight:t?t.height:"",ownerURL:l.getValue("owner").getValue("url"),twitterCardType:n,twitterImages:u,ogType:"article",domain:e.url()}),a+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),a+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1"}),a+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",a):(this.set("headContainer",a.concat(this.subviews["pagination-view"].get("headContainer"))),this.updateHead())},activate:function(){var t=this,i=this.get("albumModel"),a=i.getValue("isOwner");return e.later(100,this,function(){e.use("photo-page-scrappy-view")}),e.on("albumToolbarView:layoutChange",function(e){var i=t.subviews["photo-list-view"],a=i.photoListLayout;a.targetRowHeight="justified"===e?190:430,a.fullWidthBreakoutRowCadence="justified"===e?null:3,i.setItems(t.get("albumModel").getValue("photoPageList").getList())}),a||this.appContext.getViewCounter().recordAlbumView({albumOwnerID:i.getValue("owner").getValue("id"),albumID:i.getValue("id"),referrer:this.appContext.getReferrer()}),this},onSubviewEvent:function(e,t){t&&"newPhotoAddedToAlbum"===t[0]&&this.subviews["photo-list-view"].setItems(this.get("albumModel").getValue("photoPageList").getList())},getTrackingSegments:function(){return{couldHaveSeenAd:!this.get("albumModel").getValue("owner").getValue("isPro")&&!this.appContext.getViewer().isPro,vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600538}}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","set-models","hermes-template-album-page","hermes-template-dynamic-page-head","hermes-template-head-meta","hermes-template-head-link","album-toolbar-view","album-header-view","photo-list-view","footer-full-view","photolist-aft-helper","url-helper"],langBundles:["album-page"]});YUI.add("album-privacy-models",function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ListFetchers["flickr-photosets-getPhotos"].run(e,this.appContext)}},attributes:{totalCount:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},hasPhotosPrivate:{readOnly:!0,derivedBy:["totalCount","countPhotosPublic"],defaultFn:function(t){return this.getValue(t,"totalCount")-this.getValue(t,"countPhotosPublic")}},countPhotosFamily:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},countPhotosFriend:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},countPhotosFriendFamily:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0},countPhotosPublic:{validator:function(e){return t.AttributeHelpers.validateInteger(e)},setter:function(e){return t.AttributeHelpers.coerceInteger(e)},defaultValue:0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-getPhotos-fetcher"]});